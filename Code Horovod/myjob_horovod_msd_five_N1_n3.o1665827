[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:2', device_type='GPU')]
PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')
PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU')
PhysicalDevice(name='/physical_device:GPU:2', device_type='GPU')
total len: 2670
rank: 0  len train: 890  len valid 283
Train Dataset: <BatchDataset element_spec=(TensorSpec(shape=(16, 256, 256, 3), dtype=tf.float32, name=None), TensorSpec(shape=(16, 256, 256, 1), dtype=tf.float32, name=None))>
Val Dataset: <BatchDataset element_spec=(TensorSpec(shape=(16, 256, 256, 3), dtype=tf.float32, name=None), TensorSpec(shape=(16, 256, 256, 1), dtype=tf.float32, name=None))>
(None, 256, 256, 64)
(None, 128, 128, 50)
ASPP (None, 128, 128, 256)
(None, 128, 128, 128)
Model: "DeepLabV3-Plus"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 InputLayer (InputLayer)        [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 patches (Patches)              (None, 256, 256, 3)  0           ['InputLayer[0][0]']             
                                                                                                  
 patch_embedding (PatchEmbeddin  (None, 256, 256, 64  16640      ['patches[0][0]']                
 g)                             )                                                                 
                                                                                                  
 swin_transformer (SwinTransfor  (None, 256, 256, 64  50072      ['patch_embedding[0][0]']        
 mer)                           )                                                                 
                                                                                                  
 swin_transformer_1 (SwinTransf  (None, 256, 256, 64  51096      ['swin_transformer[0][0]']       
 ormer)                         )                                                                 
                                                                                                  
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:2', device_type='GPU')]
PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')
PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU')
PhysicalDevice(name='/physical_device:GPU:2', device_type='GPU')
total len: 2670
rank: 1  len train: 890  len valid 283
Train Dataset: <BatchDataset element_spec=(TensorSpec(shape=(16, 256, 256, 3), dtype=tf.float32, name=None), TensorSpec(shape=(16, 256, 256, 1), dtype=tf.float32, name=None))>
Val Dataset: <BatchDataset element_spec=(TensorSpec(shape=(16, 256, 256, 3), dtype=tf.float32, name=None), TensorSpec(shape=(16, 256, 256, 1), dtype=tf.float32, name=None))>
(None, 256, 256, 64)
(None, 128, 128, 50)
ASPP (None, 128, 128, 256)
(None, 128, 128, 128)
Model: "DeepLabV3-Plus"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 InputLayer (InputLayer)        [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 patches (Patches)              (None, 256, 256, 3)  0           ['InputLayer[0][0]']             
                                                                                                  
 swin_transformer_2 (SwinTransf  (None, 256, 256, 64  51096      ['swin_transformer_1[0][0]']     
 ormer)                         )                                                                 
                                                                                                  
 patch_embedding (PatchEmbeddin  (None, 256, 256, 64  16640      ['patches[0][0]']                
 g)                             )                                                                 
                                                                                                  
 patch_merging (PatchMerging)   (None, 256, 256, 64  0           ['swin_transformer_2[0][0]']     
                                )                                                                 
                                                                                                  
 conv2d (Conv2D)                (None, 256, 256, 50  28850       ['patch_merging[0][0]']          
                                )                                                                 
                                                                                                  
 batch_normalization (BatchNorm  (None, 256, 256, 50  200        ['conv2d[0][0]']                 
 alization)                     )                                                                 
                                                                                                  
 activation_3 (Activation)      (None, 256, 256, 50  0           ['batch_normalization[0][0]']    
                                )                                                                 
                                                                                                  
 swin_transformer (SwinTransfor  (None, 256, 256, 64  50072      ['patch_embedding[0][0]']        
 max_pooling2d (MaxPooling2D)   (None, 128, 128, 50  0           ['activation_3[0][0]']           
 mer)                           )                                                                 
                                                                                                  
                                )                                                                 
                                                                                                  
 ASPP-AvgPool (AveragePooling2D  (None, 1, 1, 50)    0           ['max_pooling2d[0][0]']          
 )                                                                                                
                                                                                                  
 ASPP-ImagePool-CB (ConvBlock)  (None, 1, 1, 256)    13824       ['ASPP-AvgPool[0][0]']           
                                                                                                  
 block1_conv1 (Conv2D)          (None, 127, 127, 32  864         ['InputLayer[0][0]']             
                                )                                                                 
                                                                                                  
 swin_transformer_1 (SwinTransf  (None, 256, 256, 64  51096      ['swin_transformer[0][0]']       
 ormer)                         )                                                                 
                                                                                                  
 ASPP-ImagePool-UpSample (UpSam  (None, 128, 128, 25  0          ['ASPP-ImagePool-CB[0][0]']      
 pling2D)                       6)                                                                
                                                                                                  
 ASPP-CB-1 (ConvBlock)          (None, 128, 128, 25  13824       ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 swin_transformer_2 (SwinTransf  (None, 256, 256, 64  51096      ['swin_transformer_1[0][0]']     
 ASPP-CB-6 (ConvBlock)          (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
 ormer)                         )                                                                 
                                                                                                  
                                6)                                                                
                                                                                                  
 patch_merging (PatchMerging)   (None, 256, 256, 64  0           ['swin_transformer_2[0][0]']     
                                )                                                                 
                                                                                                  
 ASPP-CB-12 (ConvBlock)         (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
 conv2d (Conv2D)                (None, 256, 256, 50  28850       ['patch_merging[0][0]']          
                                6)                                                                
                                                                                                  
                                )                                                                 
                                                                                                  
 batch_normalization (BatchNorm  (None, 256, 256, 50  200        ['conv2d[0][0]']                 
 alization)                     )                                                                 
                                                                                                  
 ASPP-CB-18 (ConvBlock)         (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 activation_3 (Activation)      (None, 256, 256, 50  0           ['batch_normalization[0][0]']    
                                )                                                                 
                                                                                                  
 block1_conv1_bn (BatchNormaliz  (None, 127, 127, 32  128        ['block1_conv1[0][0]']           
 max_pooling2d (MaxPooling2D)   (None, 128, 128, 50  0           ['activation_3[0][0]']           
 ation)                         )                                                                 
                                                                                                  
                                )                                                                 
                                                                                                  
 ASPP-AvgPool (AveragePooling2D  (None, 1, 1, 50)    0           ['max_pooling2d[0][0]']          
 ASPP-Combine (Concatenate)     (None, 128, 128, 12  0           ['ASPP-ImagePool-UpSample[0][0]',
 )                                                                                                
                                                                                                  
                                80)                               'ASPP-CB-1[0][0]',              
                                                                  'ASPP-CB-6[0][0]',              
                                                                  'ASPP-CB-12[0][0]',             
                                                                  'ASPP-CB-18[0][0]']             
                                                                                                  
 block1_conv1_act (Activation)  (None, 127, 127, 32  0           ['block1_conv1_bn[0][0]']        
                                )                                                                 
                                                                                                  
 ASPP-ImagePool-CB (ConvBlock)  (None, 1, 1, 256)    13824       ['ASPP-AvgPool[0][0]']           
                                                                                                  
 block1_conv1 (Conv2D)          (None, 127, 127, 32  864         ['InputLayer[0][0]']             
 ASPP-Net (ConvBlock)           (None, 128, 128, 25  328704      ['ASPP-Combine[0][0]']           
                                )                                                                 
                                                                                                  
                                6)                                                                
                                                                                                  
 ASPP-ImagePool-UpSample (UpSam  (None, 128, 128, 25  0          ['ASPP-ImagePool-CB[0][0]']      
 zero_padding2d (ZeroPadding2D)  (None, 128, 128, 32  0          ['block1_conv1_act[0][0]']       
 pling2D)                       6)                                                                
                                                                                                  
                                )                                                                 
                                                                                                  
 AtrousSpatial (UpSampling2D)   (None, 128, 128, 25  0           ['ASPP-Net[0][0]']               
                                6)                                                                
                                                                                                  
 ASPP-CB-1 (ConvBlock)          (None, 128, 128, 25  13824       ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 LLF-ConvBlock (ConvBlock)      (None, 128, 128, 12  4608        ['zero_padding2d[0][0]']         
                                8)                                                                
                                                                                                  
 Combine-LLF-ASPP (Concatenate)  (None, 128, 128, 38  0          ['AtrousSpatial[0][0]',          
                                4)                                'LLF-ConvBlock[0][0]']          
                                                                                                  
 ASPP-CB-6 (ConvBlock)          (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 Top-ConvBlock-1 (ConvBlock)    (None, 128, 128, 25  885760      ['Combine-LLF-ASPP[0][0]']       
                                6)                                                                
                                                                                                  
 ASPP-CB-12 (ConvBlock)         (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 Top-ConvBlock-2 (ConvBlock)    (None, 128, 128, 25  590848      ['Top-ConvBlock-1[0][0]']        
                                6)                                                                
                                                                                                  
 ASPP-CB-18 (ConvBlock)         (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 Top-UpSample (UpSampling2D)    (None, 256, 256, 25  0           ['Top-ConvBlock-2[0][0]']        
                                6)                                                                
                                                                                                  
 OutputMask (Conv2D)            (None, 256, 256, 1)  2304        ['Top-UpSample[0][0]']           
                                                                                                  
==================================================================================================
 block1_conv1_bn (BatchNormaliz  (None, 127, 127, 32  128        ['block1_conv1[0][0]']           
 ation)                         )                                                                 
                                                                                                  
 ASPP-Combine (Concatenate)     (None, 128, 128, 12  0           ['ASPP-ImagePool-UpSample[0][0]',
[PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU'), PhysicalDevice(name='/physical_device:GPU:2', device_type='GPU')]
PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')
PhysicalDevice(name='/physical_device:GPU:1', device_type='GPU')
PhysicalDevice(name='/physical_device:GPU:2', device_type='GPU')
total len: 2670
rank: 2  len train: 890  len valid 284
Train Dataset: <BatchDataset element_spec=(TensorSpec(shape=(16, 256, 256, 3), dtype=tf.float32, name=None), TensorSpec(shape=(16, 256, 256, 1), dtype=tf.float32, name=None))>
Val Dataset: <BatchDataset element_spec=(TensorSpec(shape=(16, 256, 256, 3), dtype=tf.float32, name=None), TensorSpec(shape=(16, 256, 256, 1), dtype=tf.float32, name=None))>
(None, 256, 256, 64)
(None, 128, 128, 50)
ASPP (None, 128, 128, 256)
(None, 128, 128, 128)
Model: "DeepLabV3-Plus"
__________________________________________________________________________________________________
                                80)                               'ASPP-CB-1[0][0]',              
                                                                  'ASPP-CB-6[0][0]',              
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
                                                                  'ASPP-CB-12[0][0]',             
                                                                  'ASPP-CB-18[0][0]']             
                                                                                                  
 block1_conv1_act (Activation)  (None, 127, 127, 32  0           ['block1_conv1_bn[0][0]']        
                                )                                                                 
                                                                                                  
 InputLayer (InputLayer)        [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 patches (Patches)              (None, 256, 256, 3)  0           ['InputLayer[0][0]']             
                                                                                                  
 ASPP-Net (ConvBlock)           (None, 128, 128, 25  328704      ['ASPP-Combine[0][0]']           
                                6)                                                                
                                                                                                  
 zero_padding2d (ZeroPadding2D)  (None, 128, 128, 32  0          ['block1_conv1_act[0][0]']       
                                )                                                                 
                                                                                                  
 AtrousSpatial (UpSampling2D)   (None, 128, 128, 25  0           ['ASPP-Net[0][0]']               
 patch_embedding (PatchEmbeddin  (None, 256, 256, 64  16640      ['patches[0][0]']                
                                6)                                                                
                                                                                                  
 g)                             )                                                                 
                                                                                                  
 LLF-ConvBlock (ConvBlock)      (None, 128, 128, 12  4608        ['zero_padding2d[0][0]']         
                                8)                                                                
                                                                                                  
 Combine-LLF-ASPP (Concatenate)  (None, 128, 128, 38  0          ['AtrousSpatial[0][0]',          
                                4)                                'LLF-ConvBlock[0][0]']          
                                                                                                  
 swin_transformer (SwinTransfor  (None, 256, 256, 64  50072      ['patch_embedding[0][0]']        
 Top-ConvBlock-1 (ConvBlock)    (None, 128, 128, 25  885760      ['Combine-LLF-ASPP[0][0]']       
 mer)                           )                                                                 
                                                                                                  
                                6)                                                                
                                                                                                  
 Top-ConvBlock-2 (ConvBlock)    (None, 128, 128, 25  590848      ['Top-ConvBlock-1[0][0]']        
                                6)                                                                
                                                                                                  
 Top-UpSample (UpSampling2D)    (None, 256, 256, 25  0           ['Top-ConvBlock-2[0][0]']        
                                6)                                                                
                                                                                                  
 OutputMask (Conv2D)            (None, 256, 256, 1)  2304        ['Top-UpSample[0][0]']           
                                                                                                  
==================================================================================================
 swin_transformer_1 (SwinTransf  (None, 256, 256, 64  51096      ['swin_transformer[0][0]']       
 ormer)                         )                                                                 
                                                                                                  
 swin_transformer_2 (SwinTransf  (None, 256, 256, 64  51096      ['swin_transformer_1[0][0]']     
 ormer)                         )                                                                 
                                                                                                  
Total params: 2,387,490
Trainable params: 2,380,878
Non-trainable params: 6,612
__________________________________________________________________________________________________
 patch_merging (PatchMerging)   (None, 256, 256, 64  0           ['swin_transformer_2[0][0]']     
                                )                                                                 
                                                                                                  
 conv2d (Conv2D)                (None, 256, 256, 50  28850       ['patch_merging[0][0]']          
                                )                                                                 
                                                                                                  
 batch_normalization (BatchNorm  (None, 256, 256, 50  200        ['conv2d[0][0]']                 
 alization)                     )                                                                 
                                                                                                  
 activation_3 (Activation)      (None, 256, 256, 50  0           ['batch_normalization[0][0]']    
                                )                                                                 
                                                                                                  
Model: "DeepLabV3-Plus"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 max_pooling2d (MaxPooling2D)   (None, 128, 128, 50  0           ['activation_3[0][0]']           
                                )                                                                 
                                                                                                  
 ASPP-AvgPool (AveragePooling2D  (None, 1, 1, 50)    0           ['max_pooling2d[0][0]']          
 )                                                                                                
                                                                                                  
 InputLayer (InputLayer)        [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 patches (Patches)              (None, 256, 256, 3)  0           ['InputLayer[0][0]']             
                                                                                                  
 ASPP-ImagePool-CB (ConvBlock)  (None, 1, 1, 256)    13824       ['ASPP-AvgPool[0][0]']           
                                                                                                  
 patch_embedding (PatchEmbeddin  (None, 256, 256, 64  16640      ['patches[0][0]']                
 g)                             )                                                                 
                                                                                                  
 block1_conv1 (Conv2D)          (None, 127, 127, 32  864         ['InputLayer[0][0]']             
                                )                                                                 
                                                                                                  
 ASPP-ImagePool-UpSample (UpSam  (None, 128, 128, 25  0          ['ASPP-ImagePool-CB[0][0]']      
 pling2D)                       6)                                                                
                                                                                                  
 ASPP-CB-1 (ConvBlock)          (None, 128, 128, 25  13824       ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 swin_transformer (SwinTransfor  (None, 256, 256, 64  50072      ['patch_embedding[0][0]']        
 mer)                           )                                                                 
                                                                                                  
 ASPP-CB-6 (ConvBlock)          (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
Total params: 2,387,490
Trainable params: 2,380,878
Non-trainable params: 6,612
__________________________________________________________________________________________________
 swin_transformer_1 (SwinTransf  (None, 256, 256, 64  51096      ['swin_transformer[0][0]']       
 ormer)                         )                                                                 
                                                                                                  
 ASPP-CB-12 (ConvBlock)         (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 ASPP-CB-18 (ConvBlock)         (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 swin_transformer_2 (SwinTransf  (None, 256, 256, 64  51096      ['swin_transformer_1[0][0]']     
Model: "DeepLabV3-Plus"
__________________________________________________________________________________________________
 block1_conv1_bn (BatchNormaliz  (None, 127, 127, 32  128        ['block1_conv1[0][0]']           
 ormer)                         )                                                                 
                                                                                                  
 ation)                         )                                                                 
                                                                                                  
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 patch_merging (PatchMerging)   (None, 256, 256, 64  0           ['swin_transformer_2[0][0]']     
                                )                                                                 
                                                                                                  
 ASPP-Combine (Concatenate)     (None, 128, 128, 12  0           ['ASPP-ImagePool-UpSample[0][0]',
                                80)                               'ASPP-CB-1[0][0]',              
                                                                  'ASPP-CB-6[0][0]',              
                                                                  'ASPP-CB-12[0][0]',             
 conv2d (Conv2D)                (None, 256, 256, 50  28850       ['patch_merging[0][0]']          
 InputLayer (InputLayer)        [(None, 256, 256, 3  0           []                               
                                                                  'ASPP-CB-18[0][0]']             
                                                                                                  
                                )]                                                                
                                )                                                                 
                                                                                                  
                                                                                                  
 block1_conv1_act (Activation)  (None, 127, 127, 32  0           ['block1_conv1_bn[0][0]']        
 patches (Patches)              (None, 256, 256, 3)  0           ['InputLayer[0][0]']             
                                                                                                  
                                )                                                                 
                                                                                                  
 batch_normalization (BatchNorm  (None, 256, 256, 50  200        ['conv2d[0][0]']                 
 alization)                     )                                                                 
                                                                                                  
 activation_3 (Activation)      (None, 256, 256, 50  0           ['batch_normalization[0][0]']    
                                )                                                                 
                                                                                                  
 patch_embedding (PatchEmbeddin  (None, 256, 256, 64  16640      ['patches[0][0]']                
 g)                             )                                                                 
                                                                                                  
 ASPP-Net (ConvBlock)           (None, 128, 128, 25  328704      ['ASPP-Combine[0][0]']           
 max_pooling2d (MaxPooling2D)   (None, 128, 128, 50  0           ['activation_3[0][0]']           
                                6)                                                                
                                                                                                  
                                )                                                                 
                                                                                                  
 ASPP-AvgPool (AveragePooling2D  (None, 1, 1, 50)    0           ['max_pooling2d[0][0]']          
 zero_padding2d (ZeroPadding2D)  (None, 128, 128, 32  0          ['block1_conv1_act[0][0]']       
 )                                                                                                
                                                                                                  
                                )                                                                 
                                                                                                  
 AtrousSpatial (UpSampling2D)   (None, 128, 128, 25  0           ['ASPP-Net[0][0]']               
                                6)                                                                
                                                                                                  
 ASPP-ImagePool-CB (ConvBlock)  (None, 1, 1, 256)    13824       ['ASPP-AvgPool[0][0]']           
                                                                                                  
 swin_transformer (SwinTransfor  (None, 256, 256, 64  50072      ['patch_embedding[0][0]']        
 mer)                           )                                                                 
                                                                                                  
 block1_conv1 (Conv2D)          (None, 127, 127, 32  864         ['InputLayer[0][0]']             
                                )                                                                 
                                                                                                  
 LLF-ConvBlock (ConvBlock)      (None, 128, 128, 12  4608        ['zero_padding2d[0][0]']         
                                8)                                                                
                                                                                                  
 ASPP-ImagePool-UpSample (UpSam  (None, 128, 128, 25  0          ['ASPP-ImagePool-CB[0][0]']      
 pling2D)                       6)                                                                
                                                                                                  
 Combine-LLF-ASPP (Concatenate)  (None, 128, 128, 38  0          ['AtrousSpatial[0][0]',          
                                4)                                'LLF-ConvBlock[0][0]']          
                                                                                                  
 ASPP-CB-1 (ConvBlock)          (None, 128, 128, 25  13824       ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 Top-ConvBlock-1 (ConvBlock)    (None, 128, 128, 25  885760      ['Combine-LLF-ASPP[0][0]']       
                                6)                                                                
                                                                                                  
 swin_transformer_1 (SwinTransf  (None, 256, 256, 64  51096      ['swin_transformer[0][0]']       
 ormer)                         )                                                                 
                                                                                                  
 ASPP-CB-6 (ConvBlock)          (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 Top-ConvBlock-2 (ConvBlock)    (None, 128, 128, 25  590848      ['Top-ConvBlock-1[0][0]']        
                                6)                                                                
                                                                                                  
 Top-UpSample (UpSampling2D)    (None, 256, 256, 25  0           ['Top-ConvBlock-2[0][0]']        
                                6)                                                                
                                                                                                  
 ASPP-CB-12 (ConvBlock)         (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 swin_transformer_2 (SwinTransf  (None, 256, 256, 64  51096      ['swin_transformer_1[0][0]']     
 OutputMask (Conv2D)            (None, 256, 256, 1)  2304        ['Top-UpSample[0][0]']           
                                                                                                  
==================================================================================================
 ormer)                         )                                                                 
                                                                                                  
 patch_merging (PatchMerging)   (None, 256, 256, 64  0           ['swin_transformer_2[0][0]']     
                                )                                                                 
                                                                                                  
 ASPP-CB-18 (ConvBlock)         (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 conv2d (Conv2D)                (None, 256, 256, 50  28850       ['patch_merging[0][0]']          
                                )                                                                 
                                                                                                  
 block1_conv1_bn (BatchNormaliz  (None, 127, 127, 32  128        ['block1_conv1[0][0]']           
 ation)                         )                                                                 
                                                                                                  
 batch_normalization (BatchNorm  (None, 256, 256, 50  200        ['conv2d[0][0]']                 
 ASPP-Combine (Concatenate)     (None, 128, 128, 12  0           ['ASPP-ImagePool-UpSample[0][0]',
 alization)                     )                                                                 
                                                                                                  
                                80)                               'ASPP-CB-1[0][0]',              
                                                                  'ASPP-CB-6[0][0]',              
                                                                  'ASPP-CB-12[0][0]',             
                                                                  'ASPP-CB-18[0][0]']             
                                                                                                  
 activation_3 (Activation)      (None, 256, 256, 50  0           ['batch_normalization[0][0]']    
                                )                                                                 
                                                                                                  
 block1_conv1_act (Activation)  (None, 127, 127, 32  0           ['block1_conv1_bn[0][0]']        
                                )                                                                 
                                                                                                  
 max_pooling2d (MaxPooling2D)   (None, 128, 128, 50  0           ['activation_3[0][0]']           
                                )                                                                 
                                                                                                  
 ASPP-AvgPool (AveragePooling2D  (None, 1, 1, 50)    0           ['max_pooling2d[0][0]']          
 )                                                                                                
                                                                                                  
 ASPP-Net (ConvBlock)           (None, 128, 128, 25  328704      ['ASPP-Combine[0][0]']           
                                6)                                                                
                                                                                                  
 zero_padding2d (ZeroPadding2D)  (None, 128, 128, 32  0          ['block1_conv1_act[0][0]']       
                                )                                                                 
                                                                                                  
 ASPP-ImagePool-CB (ConvBlock)  (None, 1, 1, 256)    13824       ['ASPP-AvgPool[0][0]']           
                                                                                                  
 AtrousSpatial (UpSampling2D)   (None, 128, 128, 25  0           ['ASPP-Net[0][0]']               
                                6)                                                                
                                                                                                  
 block1_conv1 (Conv2D)          (None, 127, 127, 32  864         ['InputLayer[0][0]']             
                                )                                                                 
                                                                                                  
 ASPP-ImagePool-UpSample (UpSam  (None, 128, 128, 25  0          ['ASPP-ImagePool-CB[0][0]']      
 LLF-ConvBlock (ConvBlock)      (None, 128, 128, 12  4608        ['zero_padding2d[0][0]']         
 pling2D)                       6)                                                                
                                                                                                  
                                8)                                                                
                                                                                                  
 Combine-LLF-ASPP (Concatenate)  (None, 128, 128, 38  0          ['AtrousSpatial[0][0]',          
                                4)                                'LLF-ConvBlock[0][0]']          
                                                                                                  
 ASPP-CB-1 (ConvBlock)          (None, 128, 128, 25  13824       ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 Top-ConvBlock-1 (ConvBlock)    (None, 128, 128, 25  885760      ['Combine-LLF-ASPP[0][0]']       
                                6)                                                                
                                                                                                  
 ASPP-CB-6 (ConvBlock)          (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 Top-ConvBlock-2 (ConvBlock)    (None, 128, 128, 25  590848      ['Top-ConvBlock-1[0][0]']        
                                6)                                                                
                                                                                                  
 Top-UpSample (UpSampling2D)    (None, 256, 256, 25  0           ['Top-ConvBlock-2[0][0]']        
                                6)                                                                
                                                                                                  
 ASPP-CB-12 (ConvBlock)         (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 OutputMask (Conv2D)            (None, 256, 256, 1)  2304        ['Top-UpSample[0][0]']           
                                                                                                  
==================================================================================================
 ASPP-CB-18 (ConvBlock)         (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 block1_conv1_bn (BatchNormaliz  (None, 127, 127, 32  128        ['block1_conv1[0][0]']           
 ation)                         )                                                                 
                                                                                                  
 ASPP-Combine (Concatenate)     (None, 128, 128, 12  0           ['ASPP-ImagePool-UpSample[0][0]',
                                80)                               'ASPP-CB-1[0][0]',              
                                                                  'ASPP-CB-6[0][0]',              
Total params: 2,387,490
Trainable params: 2,380,878
Non-trainable params: 6,612
                                                                  'ASPP-CB-12[0][0]',             
__________________________________________________________________________________________________
                                                                  'ASPP-CB-18[0][0]']             
                                                                                                  
 block1_conv1_act (Activation)  (None, 127, 127, 32  0           ['block1_conv1_bn[0][0]']        
                                )                                                                 
                                                                                                  
 ASPP-Net (ConvBlock)           (None, 128, 128, 25  328704      ['ASPP-Combine[0][0]']           
                                6)                                                                
                                                                                                  
 zero_padding2d (ZeroPadding2D)  (None, 128, 128, 32  0          ['block1_conv1_act[0][0]']       
                                )                                                                 
                                                                                                  
 AtrousSpatial (UpSampling2D)   (None, 128, 128, 25  0           ['ASPP-Net[0][0]']               
Model: "DeepLabV3-Plus"
__________________________________________________________________________________________________
                                6)                                                                
                                                                                                  
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 LLF-ConvBlock (ConvBlock)      (None, 128, 128, 12  4608        ['zero_padding2d[0][0]']         
 InputLayer (InputLayer)        [(None, 256, 256, 3  0           []                               
                                8)                                                                
                                )]                                                                
                                                                                                  
                                                                                                  
 Combine-LLF-ASPP (Concatenate)  (None, 128, 128, 38  0          ['AtrousSpatial[0][0]',          
 patches (Patches)              (None, 256, 256, 3)  0           ['InputLayer[0][0]']             
                                                                                                  
                                4)                                'LLF-ConvBlock[0][0]']          
                                                                                                  
 patch_embedding (PatchEmbeddin  (None, 256, 256, 64  16640      ['patches[0][0]']                
 Top-ConvBlock-1 (ConvBlock)    (None, 128, 128, 25  885760      ['Combine-LLF-ASPP[0][0]']       
 g)                             )                                                                 
                                                                                                  
                                6)                                                                
                                                                                                  
 Top-ConvBlock-2 (ConvBlock)    (None, 128, 128, 25  590848      ['Top-ConvBlock-1[0][0]']        
                                6)                                                                
                                                                                                  
 Top-UpSample (UpSampling2D)    (None, 256, 256, 25  0           ['Top-ConvBlock-2[0][0]']        
                                6)                                                                
                                                                                                  
 swin_transformer (SwinTransfor  (None, 256, 256, 64  50072      ['patch_embedding[0][0]']        
 OutputMask (Conv2D)            (None, 256, 256, 1)  2304        ['Top-UpSample[0][0]']           
 mer)                           )                                                                 
                                                                                                  
==================================================================================================
                                                                                                  
Total params: 2,387,490
Trainable params: 2,380,878
Non-trainable params: 6,612
__________________________________________________________________________________________________
 swin_transformer_1 (SwinTransf  (None, 256, 256, 64  51096      ['swin_transformer[0][0]']       
 ormer)                         )                                                                 
                                                                                                  
 swin_transformer_2 (SwinTransf  (None, 256, 256, 64  51096      ['swin_transformer_1[0][0]']     
 ormer)                         )                                                                 
                                                                                                  
 patch_merging (PatchMerging)   (None, 256, 256, 64  0           ['swin_transformer_2[0][0]']     
                                )                                                                 
                                                                                                  
 conv2d (Conv2D)                (None, 256, 256, 50  28850       ['patch_merging[0][0]']          
                                )                                                                 
                                                                                                  
 batch_normalization (BatchNorm  (None, 256, 256, 50  200        ['conv2d[0][0]']                 
 alization)                     )                                                                 
                                                                                                  
 activation_3 (Activation)      (None, 256, 256, 50  0           ['batch_normalization[0][0]']    
                                )                                                                 
                                                                                                  
 max_pooling2d (MaxPooling2D)   (None, 128, 128, 50  0           ['activation_3[0][0]']           
                                )                                                                 
                                                                                                  
 ASPP-AvgPool (AveragePooling2D  (None, 1, 1, 50)    0           ['max_pooling2d[0][0]']          
 )                                                                                                
                                                                                                  
 ASPP-ImagePool-CB (ConvBlock)  (None, 1, 1, 256)    13824       ['ASPP-AvgPool[0][0]']           
                                                                                                  
 block1_conv1 (Conv2D)          (None, 127, 127, 32  864         ['InputLayer[0][0]']             
                                )                                                                 
                                                                                                  
 ASPP-ImagePool-UpSample (UpSam  (None, 128, 128, 25  0          ['ASPP-ImagePool-CB[0][0]']      
 pling2D)                       6)                                                                
                                                                                                  
Total params: 2,387,490
Trainable params: 2,380,878
Non-trainable params: 6,612
__________________________________________________________________________________________________
 ASPP-CB-1 (ConvBlock)          (None, 128, 128, 25  13824       ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 ASPP-CB-6 (ConvBlock)          (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 ASPP-CB-12 (ConvBlock)         (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 ASPP-CB-18 (ConvBlock)         (None, 128, 128, 25  116224      ['max_pooling2d[0][0]']          
                                6)                                                                
                                                                                                  
 block1_conv1_bn (BatchNormaliz  (None, 127, 127, 32  128        ['block1_conv1[0][0]']           
 ation)                         )                                                                 
                                                                                                  
 ASPP-Combine (Concatenate)     (None, 128, 128, 12  0           ['ASPP-ImagePool-UpSample[0][0]',
                                80)                               'ASPP-CB-1[0][0]',              
                                                                  'ASPP-CB-6[0][0]',              
                                                                  'ASPP-CB-12[0][0]',             
                                                                  'ASPP-CB-18[0][0]']             
                                                                                                  
 block1_conv1_act (Activation)  (None, 127, 127, 32  0           ['block1_conv1_bn[0][0]']        
                                )                                                                 
                                                                                                  
 ASPP-Net (ConvBlock)           (None, 128, 128, 25  328704      ['ASPP-Combine[0][0]']           
                                6)                                                                
                                                                                                  
 zero_padding2d (ZeroPadding2D)  (None, 128, 128, 32  0          ['block1_conv1_act[0][0]']       
                                )                                                                 
                                                                                                  
 AtrousSpatial (UpSampling2D)   (None, 128, 128, 25  0           ['ASPP-Net[0][0]']               
                                6)                                                                
                                                                                                  
 LLF-ConvBlock (ConvBlock)      (None, 128, 128, 12  4608        ['zero_padding2d[0][0]']         
                                8)                                                                
                                                                                                  
 Combine-LLF-ASPP (Concatenate)  (None, 128, 128, 38  0          ['AtrousSpatial[0][0]',          
                                4)                                'LLF-ConvBlock[0][0]']          
                                                                                                  
 Top-ConvBlock-1 (ConvBlock)    (None, 128, 128, 25  885760      ['Combine-LLF-ASPP[0][0]']       
                                6)                                                                
                                                                                                  
 Top-ConvBlock-2 (ConvBlock)    (None, 128, 128, 25  590848      ['Top-ConvBlock-1[0][0]']        
                                6)                                                                
                                                                                                  
 Top-UpSample (UpSampling2D)    (None, 256, 256, 25  0           ['Top-ConvBlock-2[0][0]']        
                                6)                                                                
                                                                                                  
 OutputMask (Conv2D)            (None, 256, 256, 1)  2304        ['Top-UpSample[0][0]']           
                                                                                                  
==================================================================================================
Total params: 2,387,490
Trainable params: 2,380,878
Non-trainable params: 6,612
__________________________________________________________________________________________________
Total training time: 5436.50 seconds
Total training time: 5436.50 seconds
/scratch/09819/xeh13/python-envs/test/lib/python3.9/site-packages/sklearn/metrics/_classification.py:386: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/scratch/09819/xeh13/python-envs/test/lib/python3.9/site-packages/sklearn/metrics/_classification.py:386: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(
/scratch/09819/xeh13/python-envs/test/lib/python3.9/site-packages/sklearn/metrics/_classification.py:386: UserWarning: A single label was found in 'y_true' and 'y_pred'. For the confusion matrix to have the correct shape, use the 'labels' parameter to pass all known labels.
  warnings.warn(

Epoch 3: finished gradual learning rate warmup to 0.003.
Total training time: 5436.50 seconds
Test Dataset: <BatchDataset element_spec=(TensorSpec(shape=(16, 256, 256, 3), dtype=tf.float32, name=None), TensorSpec(shape=(16, 256, 256, 1), dtype=tf.float32, name=None))>
Test Dataset: <BatchDataset element_spec=(TensorSpec(shape=(16, 256, 256, 3), dtype=tf.float32, name=None), TensorSpec(shape=(16, 256, 256, 1), dtype=tf.float32, name=None))>
Mean Dice coefficient: 0.8119246320388864
Mean IoU (Jaccard) score: 0.6835317676798808
Mean Matthews Correlation Coefficient: 0.7983809282022766
Mean Accuracy: 0.9734037717183431
Mean Precision: 0.7895294935292688
Mean Recall (Sensitivity): 0.8369811147093406
Mean F1 score: 0.8119246320387566
Mean Dice coefficient: 0.4122258534631206
Mean IoU (Jaccard) score: 0.3222812889256807
Mean Matthews Correlation Coefficient: 0.39342475336576826
Mean Accuracy: 0.9972067515055338
Mean Precision: 0.8535481820850918
Mean Recall (Sensitivity): 0.3925047353033232
Mean F1 score: 0.4122258517002147
c301-001
c301-001
